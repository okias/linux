# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: "http://devicetree.org/schemas/soc/qcom/qcom,glink.yaml#"
$schema: "http://devicetree.org/meta-schemas/core.yaml#"

title: Qualcomm GLINK edge

description: |
  Qualcomm GLINK edge, a fifo based mechanism for communication between
  subsystem-pairs on various Qualcomm platforms. Two types of edges can be
  described by the binding; the GLINK RPM edge and a SMEM based.

maintainers:
  - Bjorn Andersson <bjorn.andersson@linaro.org>

properties:
  $nodename:
    pattern: "^(rpm-)?glink(-edge)?$"

  compatible:
    const: qcom,glink-rpm

  label:
    $ref: /schemas/types.yaml#/definitions/string
    description: should specify the subsystem name this edge corresponds to

  interrupts:
    description: >
      should specify the IRQ used by the remote processor to
      signal this processor about communication related events
    maxItems: 1

  mboxes:
    description: >
      reference to the "rpm_hlos" mailbox in APCS, as described
      in mailbox/mailbox.txt

  qcom,remote-pid:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: specifies the identifier of the remote endpoint of this edge

  qcom,rpm-msg-ram:
    $ref: /schemas/types.yaml#/definitions/phandle
    description: RPM message memory resource

additionalProperties:
  type: object
  properties:
    qcom,glink-channels:
      $ref: /schemas/types.yaml#/definitions/string
      description: >
        a list of channels tied to this function, used for matching
        the function to a set of virtual channels

    qcom,intents:
      $ref: /schemas/types.yaml#/definitions/uint32-array
      description: >
        a list of size, amount pairs describing what intents should
        be preallocated for this virtual channel. This can be used
        to tweak the default intents available for the channel to
        meet expectations of the remote

  required:
    - qcom,glink-channels

  additionalProperties: false

required:
  - interrupts
  - mboxes
  - qcom,smem
  - qcom,local-pid
  - qcom,remote-pid

anyOf:
  - required:
      - qcom,remote-pid
  - required:
      - qcom,rpm-msg-ram

examples:
  # The following example represents the GLINK RPM node on a MSM8996 device,
  # with the function for the "rpm_request" channel defined, which
  # is used for regulators and root clocks.
  - |
    rpm-glink {
        compatible = "qcom,glink-rpm";

        interrupts = <0 168 1>;

        qcom,rpm-msg-ram = <&rpm_msg_ram>;

        mboxes = <&apcs_glb 0>;

        rpm-requests {
            compatible = "qcom,rpm-msm8996";
            qcom,glink-channels = "rpm_requests";

            qcom,intents = <0x400 5
                            0x800 1>;
        };
    };
